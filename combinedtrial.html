<!DOCTYPE html>
<html>
  <head>
    <title>Smoothie Chart Example</title>
    <script type="text/javascript" src="http://smoothiecharts.org/smoothie.js"></script>
<script src="https://dweet.io/client/dweet.io.min.js"></script>


<script>
function resizeCanvas() {
    var canvs = document.getElementById("mycanvas");
    canvs.width = window.innerWidth*.8;
    canvs.height = window.innerHeight* 0.15;
}

 var heartrate =50;
</script>

</body>
  </head>
  <body onload="resizeCanvas();", style="background-color:black;">
<table>
  <tr>
    <td>    <canvas id="mycanvas"></canvas>  </td>
    <td style="font-size:150px; font:verdana; color:rgb(0, 255, 0);">44</script></td>
  </tr>
  <tr>
    <td>Centro comercial Moctezuma</td>
    <td>Mexico</td>
  </tr>
</table>
    <h1>Smoothie Example</h1>



    <script type="text/javascript">

 var heartrate =50;
dweetio.listen_for("ecgtester", function(dweet){
dweetio.get_latest_dweet_for("ecgtester", function(err, dweet){


    var dweet = dweet[0]; // Dweet is always an array of 1
    
    console.log(dweet.content); // The content of the dweet
 
   var heartrate = dweet.content["hr"];

});
    // This will be called anytime there is a new dweet for my-thing

});
 



      var line1 = new TimeSeries();
   const qrs =[0,0.6,1,2.1,2.6,2,1.8,0.3,0,-0.1,0,0.5,1,25,6,1,-0.5,-2,-0.2,0.1,0.1,-0.1,0,0.1,-0.2,0,0.2,0.8,1,2,3,3.2,3.8,4.1,4.3,4.2,4,3.8,3.5,3,2,1,0,0.1,-0.1,0,-0.1,-0.2,0.1];      
    var i = 0;

  var space = new Array(((4800)-(48*heartrate))/60).fill(0);

var ecg= qrs.concat(space);

      setInterval(function() {
        line1.append(new Date().getTime(),ecg[i]);if (i < ecg.length) {i++;} else {i = 0;}}, 40);

      var smoothie = new SmoothieChart({labels:{disabled:true},maxValueScale:1.1,minValueScale:1.1,maxValue:30,minValue:-30, grid: { strokeStyle: 'rgb(0, 0, 0)', fillStyle: 'rgb(0, 0, 0)', lineWidth: 0, millisPerLine: 250} });
      smoothie.addTimeSeries(line1, { strokeStyle: 'rgb(0, 255, 0)', fillStyle: 'rgba(0, 255, 0, 0.0)', lineWidth: 2 });
   

      smoothie.streamTo(document.getElementById("mycanvas"), 1000);
    </script>

 
  </body>
</html>